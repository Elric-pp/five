var app=angular.module("app",[]);app.controller("appCtrl",["$scope",function(e){e.index=1,e.changeIndex=function(o){e.index=o},e.globalPopup=!1,e.showGlobalPopupTip=!0,e.globalPopupTip={},e.closePopup=function(){e.mainPopup=!1,e.showGlobalPopupTip=!1,e.globalPopupTip={}},e.popup=function(o){e.globalPopup=!0,e.showGlobalPopupTip=!0,e.globalPopupTip=o},e.globalTip={on:!1,tip:""},e.myalter=function(o){e.globalTip.on=!0,e.globalTip.tip=o,$timeout(function(){e.globalTip.on=!1},1500)}}]),app.controller("groupCtrl",["$scope","groupService",function(e,o){}]),app.controller("homeCtrl",["$scope","$timeout","homeService",function(e,o,n){e.tabIndex=1,e.changeTab=function(o){e.tabIndex=o},e.addmovie=function(){console.log(e.globalPopupTip);var p={title:"新增电影",hideCloseBtn:!1,type:1,isPwd:!1,okBtnText:"添加",cancelBtnText:"取消",filed:"",callback:function(){if(""==e.globalPopupTip.filed)e.globalTip.tip=" 分组名不能为空 ",e.globalTip.on=!0,o(function(){e.globalTip.on=!1},3e3);else{var p=n.addmovie(e.globalPopupTip.filed);p.success(function(n){if(0==n.status){var p="添加成功";e.closePopup(),e.globalTip.tip=p,e.globalTip.on=!0,o(function(){e.globalTip.on=!1},1500),e.Term.gettg(),e.Term.getterms("",1)}}).error(function(n,p){var r="添加失败";e.closePopup(),e.globalTip.tip=r,e.globalTip.on=!0,o(function(){e.globalTip.on=!1},1500)}),e.closePopup()}},cancel:e.closePopup};e.popup(p)}}]),app.controller("loginCtrl",["$scope","$timeout","loginService",function(e,o,n){e.userName="",e.passwd="",e.login=function(){if(""==e.username||""==e.passwd)return e.myalter("用户名或密码不能为空"),!1;var p=n.login(e.userName,e.passwd);p.success(function(n){console.log(n),e.myalter(n.msg),0==n.status&&o(function(){window.location=n.redirect},1e3)}).error(function(o){console.log(o),e.myalter("出错了")})},e.regPage=!1,e.reg={username:"",passwd:"",repasswd:"",regis:function(){if(""==e.reg.username||""==e.reg.passwd||""==e.reg.repasswd)return e.myalter("必填字段不能为空"),!1;if(e.reg.passwd.length<=8)return e.myalter("密码太短"),!1;if(e.reg.passwd!==e.reg.repasswd)return e.myalter("两次密码不一致"),!1;var o=n.regis(e.reg.username,e.reg.passwd);o.success(function(o){console.log(o),0==o.status?(e.regPage=!1,e.myalter("注册成功"),e.reg.username="",e.reg.passwd="",e.reg.repasswd=""):e.myalter("用户已存在")})}},e.globalTip={on:!1,tip:""},e.myalter=function(n){e.globalTip.on=!0,e.globalTip.tip=n,o(function(){e.globalTip.on=!1},1500)}}]),app.controller("userCtrl",["$scope","userService",function(e,o){}]),app.service("groupService",["$http",function(e){}]),app.service("homeService",["$http",function(e){this.movies=function(){var o="/movie";return e.get(o,[])},this.addmovie=function(o){var n="/movie/add";return e.post(n,"url="+o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}}]),app.service("loginService",["$http",function(e){this.login=function(o,n){var p="/users/login";return e.post(p,"username="+o+"&password="+n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})},this.regis=function(o,n){var p="/users/regis";return e.post(p,"username="+o+"&password="+n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}}]),app.service("userService",["$http",function(e){}]);